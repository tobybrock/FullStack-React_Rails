(window.webpackJsonp=window.webpackJsonp||[]).push([[91],{"./app/scripts/controller/memberHomePage.js":function(e,t,a){function r(e,t){return null!=e?t(e):void 0}var n=a("./packages/jquery/index.js"),i=a("./app/scripts/db/auth.coffee"),o=a("./app/scripts/lib/localize.coffee"),s=a("./packages/storage/index.ts").TrelloStorage,l=a("./packages/atlassian-analytics/index.ts"),c=l.Apdex,m=l.Analytics,p=l.getScreenFromUrl,d=a("./app/scripts/lib/util/index.coffee"),u=a("./packages/analytics/index.ts").trackGTMEvent,g=a("./app/scripts/controller/memberPageHelpers.js"),f=g.isMemberOfOrg,b=g.getHomeLastTab,w=g.redirectHomeToDefaultTab,h=g.getHomeLastTabStorageKey,v=a("./app/scripts/controller/navigate.js").navigate,k=a("./packages/use-lazy-component/index.ts").importWithRetry,y=!1,S=null,H=!1;n(window).on("popstate",(function(){return H=!0}));var T=function(e,t,n,i){var o,s=a("./app/scripts/db/model-cache.coffee"),l="",c={};if(e&&t&&!n)l="organizationBoardsHomeScreen",c={teamId:r(s.findOne("Organization","name",e),(function(e){return e.id}))};else if(e||!t||n||i)if(e||t||!n||i)if(e||t||n||i){if(!i||e||t||n)return;l="organizationGettingStartedScreen"}else l="memberHomeScreen";else l="templateGalleryScreen";else l="memberBoardsHomeScreen";return m.sendOperationalEvent({action:"rendered",actionSubject:l,source:p(),containers:{organization:{id:null===(o=c)||void 0===o?void 0:o.teamId}}})};e.exports.memberHomePage=function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=t.orgname,m=t.showHomeBoardsTab,p=t.showGettingStarted,g=t.templatesData,B=t.titleKey,x=a("./app/scripts/db/model-cache.coffee");if(!i.isLoggedIn())return this.displayErrorPage();g&&"all"===g.category&&!g.shortLink&&v("/templates",{trigger:!0,replace:!0,shouldTrack:!1});var D=function(){switch(!1){case!m:return"memberBoards";default:return"memberHome"}}();return g||c.start({task:D}),x.waitFor("Member",i.myId(),(function(){return k((function(){return a.e(93).then(a.t.bind(null,"./app/scripts/controller/memberPage.js",7))})).then((function(t){var a=t.memberPage,k=d.idToDate(i.myId())>d.dateBefore({minutes:3}),M=r(i.me(),(function(e){return e.isDismissed("sent-possible-new-signup-event")}));(S||!M&&k)&&(u({event:"trello.possibleNewSignup",ed:r(i.me(),(function(e){return e.getEmailDomain()}))}),r(i.me(),(function(e){return e.dismiss("sent-possible-new-signup-event")})));var j=b.call(e);if(!(l||m||p||g||!j||"/"===j||H))return H=!1,c.cancel({task:D}),y=c.isInitialLoad&&c.initialUrl===window.location.href,v(j,{trigger:!0,replace:!0,shouldTrack:!1});if(H&&s.set(h(),window.location.pathname),l&&!f(l))return w.call(e);T(l,m,g,p),H=!1,null==S&&(S=n.cookie("simulateNewUser"));var z={username:"me",loadFn:l||m||!g?"loadMemberBoardsData":"loadMinimumMemberDataForTemplatePage",viewClassName:"MemberHomeView",getLocation:function(t){return e.getMemberBoardsUrl(t,l,m,g,p)},titleKey:B||"boards",orgname:l,showHomeBoardsTab:m,showGettingStarted:p,templatesData:g};return a.call(e,z).then((function(){var t=void 0===l?o(["page title","home"]):!l&&m?o(["page title","boards"]):r(x.findOne("Organization","name",l),(function(e){return e.get("displayName")}));return e.title(t)})).tap((function(){if("memberBoards"===D)return y&&c.resetInitialState(),c.stop({task:D}),y=!1})).done()}))}))}}}]);
//# sourceMappingURL=member-home-page.96fddf916d18994dc347.js.map